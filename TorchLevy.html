
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>TorchLevy &#8212; My sample book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">My sample book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Content with notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markdown-notebooks.html">
   Notebooks with MyST Markdown
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FTorchLevy.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/TorchLevy.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   TorchLevy
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preliminary">
   Preliminary
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-use-torchlevy">
   Why use torchlevy?
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>TorchLevy</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   TorchLevy
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preliminary">
   Preliminary
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-use-torchlevy">
   Why use torchlevy?
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="torchlevy">
<h1>TorchLevy<a class="headerlink" href="#torchlevy" title="Permalink to this headline">#</a></h1>
<p><img alt="Untitled" src="TorchLevy%20b029a35bcb694634834ece09afe85607/Untitled.png" /></p>
<p>Torchlevy is a framework for PyTorch that enables the utilization of Symmetric alpha stable distributions within the context of Levy Processes. It provides functionality for calculating probability density functions, generating samples, and calculating score associated with these distributions.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="preliminary">
<h1>Preliminary<a class="headerlink" href="#preliminary" title="Permalink to this headline">#</a></h1>
<ul>
<li><p>Symmetric alpha-stable distribution</p>
<p><img alt="Untitled" src="TorchLevy%20b029a35bcb694634834ece09afe85607/Untitled%201.png" /></p>
<p>Alpha-stable distributions are a class of heavy-tailed probability distributions that are characterized by the fact that they are stable under linear combinations. Alpha-stable distributions are also known for their heavy-tailed behavior, which means that they have thicker tails than the normal distribution and are more likely to produce large deviations from the mean.</p>
<p>Symmetric alpha-stable distributions are a subclass of alpha-stable distributions that are symmetric around the mean, which means that the distribution is the same whether you reflect it about the mean or not. In other words, if X is a random variable distributed according to a symmetric alpha-stable distribution, then the distribution of -X is the same as the distribution of X.</p>
<p>The heavy-tailed behavior of alpha-stable distributions is controlled by the parameter alpha, which can take on values between 0 and 2. When alpha is less than 2, the distribution is said to have heavy tails, which means that it is more likely to produce large deviations from the mean. When alpha is equal to 2, the distribution is the same as the normal distribution and has lighter tails.</p>
<ul>
<li><p>more detail</p>
<p>The probability density function of a symmetric alpha-stable distribution is given by:</p>
<p><span class="math notranslate nohighlight">\(f(x) = \left( \frac{1}{2 \beta B(1/\alpha, 1/\alpha)} \right) |x|^{-1 - \alpha} \exp{\left( - \left( \frac{|x|}{\beta} \right)^\alpha \right)}\)</span></p>
<p>where B is the Beta function.</p>
<p>The symmetric alpha-stable distribution has several important properties. For example, it is self-similar, which means that if X is a random variable drawn from a symmetric alpha-stable distribution, then for any positive constant c, the random variable cX will also be drawn from a symmetric alpha-stable distribution with the same parameters. In addition, the symmetric alpha-stable distribution is stable under linear transformations, which means that if X1 and X2 are independent random variables drawn from a symmetric alpha-stable distribution, then the linear combination aX1 + bX2 will also be drawn from a symmetric alpha-stable distribution.</p>
<p>The symmetric alpha-stable distribution has many applications in fields such as finance, physics, and engineering, where it is used to model the distribution of returns on financial assets, the distribution of particle velocities in gases, and the distribution of signal amplitudes in communication systems, among other things.</p>
</li>
</ul>
</li>
<li><p>Lévy process</p>
<p><img alt="Untitled" src="TorchLevy%20b029a35bcb694634834ece09afe85607/Untitled%202.png" /></p>
<p>A Lévy process is a type of stochastic process that is characterized by the fact that it has stationary and independent increments. This means that if X(t) is a Lévy process, then the difference between X(t+s) and X(t) is independent of the value of X(t) and is distributed according to the same distribution for all values of t and s. Lévy processes are often used to model random processes in which the increments are uncorrelated and the distribution of the increments does not depend on the starting point.</p>
<p>A symmetric alpha-stable distribution can be used to model the increments of a Lévy process. In this case, the Lévy process is said to be an alpha-stable Lévy process. Alpha-stable Lévy processes are characterized by heavy-tailed behavior, which means that they are more likely to produce large deviations from the mean than a normal Lévy process. This makes them useful for modeling processes that exhibit large fluctuations or have the potential for rare events.</p>
<p>One important property of Lévy processes is the jump property, which states that the Lévy process can be decomposed into a continuous component and a jump component. The continuous component is similar to a Gaussian process, which means that it is continuous and has a bell-shaped distribution. Whereas the jump component resembles Poisson process, which means that it consists of a series of independent, discrete jumps. The jump component is responsible for the heavy-tailed behavior of the Lévy process and is what gives it the ability to produce large deviations from the mean.</p>
<ul>
<li><p>more detail</p>
<p>One important property of Lévy processes is the Lévy-Khintchine representation, which states that the characteristic function (the Fourier transform of the distribution) of a Lévy process can be written in the form:</p>
<p>phi(u) = exp(iux - q(u))</p>
<p>where x is the mean of the distribution and q(u) is the Lévy measure, which describes the distribution of the increments. For an alpha-stable Lévy process, the Lévy measure is given by:</p>
<p>q(u) = (|u|^alpha)/(2^(alpha-1) * gamma(alpha))</p>
<p>where alpha is the stability parameter and gamma is the gamma function. The Lévy measure determines the behavior of the Lévy process and is used to compute the moments and other statistical properties of the process.</p>
</li>
</ul>
</li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="why-use-torchlevy">
<h1>Why use torchlevy?<a class="headerlink" href="#why-use-torchlevy" title="Permalink to this headline">#</a></h1>
<p>By utilizing torchlevy, it is possible to achieve a staggering performance boost of over x1000 in comparison to using scipy’s levy_stable function. This means that computationally demanding tasks, such as those involved in deep learning, can be efficiently carried out with minimal overhead, including sampling and calculating probability density functions. For a more detailed breakdown of these figures, please refer to the table provided below.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>sampling</p></th>
<th class="head"><p>score</p></th>
<th class="head"><p>likelihood</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>scipy</p></td>
<td><p>9.055s</p></td>
<td><p>58.837s</p></td>
<td><p>14.714s</p></td>
</tr>
<tr class="row-odd"><td><p>torchlevy</p></td>
<td><p>0.009s (x1000 faster)</p></td>
<td><p>0.026s (x2000 faster)</p></td>
<td><p>0.003s (x4000 faster)</p></td>
</tr>
</tbody>
</table>
<p>In addition to providing significantly enhanced performance, torchlevy also offers a range of features that are not available in scipy. These include the ability to calculate the score for alpha stable and levy+gaussian distributions, as well as approximate scores for these distributions. Furthermore, torchlevy introduces the concept of isotropic alpha stable distributions and provides comprehensive support for sampling, probability density function calculations, and score computation for these distributions.</p>
<p>Concluding our exploration of torchlevy’s capabilities, we present <a class="reference external" href="https://openreview.net/forum?id=ErzyBArv6Ue">score-based generative model with Levy processes</a> which introduces Symmetric alpha stable noise as a replacement for traditional Gaussian noise in a diffusion model. This unique approach, made possible through the use of torchlevy, offers a novel approach to generating data. Our experimentation has demonstrated that this method performs comparably to DDPM, while achieving a faster convergence rate.</p>
<p><img alt="left : ours, right : DDPM" src="TorchLevy%20b029a35bcb694634834ece09afe85607/combined.gif" /></p>
<p>left : ours, right : DDPM</p>
<section id="id1">
<h2><a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">LevyGaussian</span></code></p>
<p><span class="math notranslate nohighlight">\(d \vec{X}_t=b\left(t, \vec{X}_t\right) d t+\sigma_B(t) d B_t+\sigma_L(t) d L_t^\alpha, \quad t \in[0,1]\)</span></p>
<p><span class="math notranslate nohighlight">\(d \overleftarrow{X}_t=\left(b\left(t, \overleftarrow{X}_t\right)-\sigma_B^2(t) \partial_x \log p_t\left(\overleftarrow{X}_t\right)-\alpha \cdot \sigma_L^\alpha(t) \frac{\partial_{|x|}^{\alpha-2} \nabla p_t\left(\vec{X}_t\right)}{p_t\left(\vec{X}_t\right)}\right) d t+\sigma_B(t) d \bar{B}_t+\sigma_L(t) d \bar{L}_t^\alpha\)</span></p>
<p>reverse form은 brownian motion과 levy process의 combined process의 score를 구해야 한다. 이 score를 구하기 위해 LevyGaussian을 지원합니다.</p>
<p><code class="docutils literal notranslate"><span class="pre">get_approx_score</span></code></p>
<ul class="simple">
<li><p>why use approximate score?</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Jupyter Book Community<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>